%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% LIVECOMS ARTICLE TEMPLATE
%%% ADAPTED FROM ELIFE ARTICLE TEMPLATE (8/10/2017)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% PREAMBLE 
\documentclass[9pt]{livecoms}
% Use the 'onehalfspacing' option for 1.5 line spacing
% Use the 'doublespacing' option for 2.0 line spacing
% use the 'lineno' option for adding line numbers. 
% Please note that these options may affect formatting.

\usepackage{lipsum} % Required to insert dummy text
\usepackage[version=4]{mhchem} 
\usepackage{siunitx}
\DeclareSIUnit\Molar{M}
\newcommand{\versionnumber}{0.0.1}  % you should update the minor version number in preprints and major version number of submissions.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% ARTICLE SETUP
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\title{Best practices for biomolecular simulation setup : v\versionnumber}

\author[1*]{Rommie E. Amaro}
\author[2*]{John D. Chodera}
\author[3*]{David L. Mobley}
\author[4*]{Antonia Mey}
\author[4*]{Julien Michel}
\affil[1]{Institution 1}
\affil[2]{Institution 2}
\affil[3]{Departments of Pharmaceutical Sciences and Chemistry, University of California, Irvine}
\affil[4]{Institution 4}

\corr{email1@example.com}{REA}  % Correspondence emails.  FMS and FS are the appropriate authors initials. 
\corr{john.chodera@choderalab.org}{JDC}
\corr{dmobley@mobleylab.org}{DLM}
\corr{email1@example.com}{AM}
\corr{email1@example.com}{JM}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% ARTICLE START
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\maketitle

\begin{abstract}
Simulations of biomolecular systems are complex and often demanding but can provide great insights and valuable quantitative predictions. 
However, these simulations require considerable human expertise to set up well, and key aspects of system preparation and setup are often overlooked for a variety of reasons.
Thus, simulations of the ``same'' biomolecular system prepared by different individuals or different software tools may yield substantially different results due to different choices made in system preparation, such as different handling of crystallographic waters, different treatment of missing residues or loops in a protein, or different choices for a ligand or receptor's protonation state. 
In some cases, human error can also play a role, with a user perhaps forgetting to check for disulfide bonds. 
Here, we identify the issues we believe are most important for users and/or software tools to consider when preparing biomolecular systems for simulation and present a checklist for users to follow to ensure they have handled the most crucial or troublesome aspects of system preparation, with recommendations for how to handle each step in the process when best practices have been established by the literature.
We also present a detailed explanation of the items in our checklist, including why we make the recommendations we do.
Additionally, because a useful checklist must necessarily be brief, we provide a discussion of other important factors to consider which did not make our major checklist. 
We believe this work provides a starting point to help reduce the number of simulations run which are flawed due to setup failures, and we hope the community will contribute to updating and improving this document to that end.

\end{abstract}

\section{Goals}

This work focuses on providing a brief checklist of the most critical and most frequently overlooked items in the preparation of biomolecular simulations, so that that practitioners can follow this checklist, and reviewers can potentially use it in evaluating manuscripts and assessing whether method descriptions are complete. 
We also focus on highlighting issues where further clarity may be needed, either via additional study, or from work of which we are unaware.
Additionally, we value input from the community on how best to handle the issues raised, and others we may have overlooked, as an additional goal of this work is to develop a set of \emph{community} best practices.
In addition to the provided checklist, we provide an explanation of why the checklist includes the items it does and why we make the recommendations we do, in order to further facilitate training and community input.

This work can perhaps also be useful for authors who are writing papers in order to help determine what details to report in their Methods section -- specifically, such sections should at minimum address the details highlighted in this document. 
%How to write a methods section by John Chodera: http://klogw.org/2016/07/28/how-to-write-a-methods-section/

Our goal in this work is to \emph{inform} about what we believe are best practices for preparation in this area and provide an aid to authors and reviewers; we have no intention of providing a set of standards which should be \emph{enforced}. 
Indeed, there may be good reasons from deviating from recommended practices in certain cases; in our view, authors should simply note any deviations and explain why they made the choices they did. 

\section{Scope}

Our focus in this work is on what is often the earliest stage of preparation of biomolecular simulations -- deciding what system to simulate and which molecules and atoms are in it in which positions. 
We deliberately avoid the issue of assigning (and potentially developing) force field parameters, as this involves many additional complexities that warrant their own ``best practices'' document.
We also, at least for now, focus on protein or protein-ligand systems, avoiding nucleic acids such as DNA or RNA as we lack the requisite expertise (though this work may be extended later to cover such cases). 
Additionally, we avoid membrane proteins for similar reasons.
Thus our overall focus is on preparation for \emph{relatively simple biomolecular simulations of soluble proteins that may include non-covalent small molecule ligands, and especially on the force field agnostic aspects of preparation.
We expect to eventually include handling of cofactors, though this is not within our initial scope.

Thus, our scope \emph{does not include} assignment of parameters from force field libraries, and especially generation of parameters (such as for unusual nonstandard residues where literature parameters may not be available, or for covalent cofactors, complex ligands or factors, etc.). 
This is both because these may be research questions, and because the particular approaches applied will often be coupled to the choice of force field to a significant extent.
Additionally, we do not include any aspects of choice of simulation protocol such as minimization, cutoffs, and other factors as, in our view, these all come significantly downstream of system preparation. 

\section{Checklist}

\subsection{ Step 0: Know what you want to simulate }

A key first step in setting up a biomolecular system is being sure you know what you intend to simulate and have planned the right simulation(s), including such aspects as:
\begin{enumerate}
\item What is the goal of your simulation(s)? Can you hope to achieve those goals with this simulation?
\item What do you know (or expect) about the potential timescales in your system, and can you hope to capture those with this simulation?
\item Will you be able to gather good enough statistics from this study, based on what you know about those timescales?
\item What will be the costs of your simulation (computer time, storage, memory, wallclock, network bandwidth, data throughput) and can you afford those costs? 
\item What are the experimental conditions (including salt conditions, buffers, cofactors, etc.)? Do you want to match those conditions in your simulation? If not, why not?
\end{enumerate}


\subsection{Protein} 

\begin{enumerate}
\item Sequence of the protein -- is it the protein you wanted to simulate? (Assays, crystal structure, intended) And what conditions do you want to simulate (are they the structural conditions)? Oligomeric state (how many chains do we need to simulate?) (Chodera/Amaro)
\item Structure selection (Mey) 
    \begin{itemize}
    \item  X-ray structural data
    \item Dealing with NMR structural ensembles
    \item Other sources of structural data: e.g. cryo-EM
    \end{itemize}
\item Disulfide bonds depending on reducing/oxidizing environments (Amaro)
\item Post-translational modifications (Chodera)
\item Model in missing residues and loops (Chodera/Amaro tag-team)
    \begin{itemize}
    \item Schrodinger tools model in short loops, but truncate long loops with proton caps (?)
    \item UCSF Modeller terrible for loops without care; Rosetta Model works well ? (JDC says)
    \item (But Amaro reports success stories with Schrodinger tools if one knows when to use them and does not try to push the tool beyond the limit of reasonable application - eg loops < 10-12 residues, otherwise need templated homology models)
    \end{itemize}
\item Protonation states and tautomers: (Mobley to draft; maybe eventually rope in someone to comment on constant pH simulations -- Jordi Juarez in Michel group has expertise here)
    \begin{itemize}
    \item ProPKA - but see Beckstein ProPkaTraj (https://github.com/Becksteinlab/propkatraj)
    \item MCCE
    \item Early stages of constant pH (e.g. Case, McCammon, Roitberg, Shen, Roux, Chodera)
    \end{itemize}
\item Crystal waters (Amaro, Mey)
\item Metal ions (JDC)


\end{enumerate}



\subsection{Ligands}

\begin{enumerate}
\item Select protonation state/tautomer (Chodera)
\item Select the correct ligand binding mode (Greg Warren, Bob Tolbert, Mobley) % Electron density, ligand binding mode, etc. 
    \begin{itemize}
    \item Is this the right ligand?
    \item Does the density support?
    \item Is that only because of crystal contacts?
    \item How do you put your new ligand in? (Get help from Amaro)
    \item ...docking, shape overlay, etc
    \item Run dynamics of ligands?
    \end{itemize}
\end{enumerate}

\subsection{Counterions/water}

\begin{enumerate}
\item No counterions, minimal counterions, or physiological ionic strength? (Mobley)

\end{enumerate}

\section{Other things to think about that didn't make the checklist}

Here, we focus on items which are also important part of system preparation, but which are less frequent causes of critical failures or are not as often or easily overlooked.

\subsection{Proteins}

Termini: Build them, or cap? Depends on length; if too long can contribute to timescales. Write some guidelines into how to know. %(Mey)

\subsection{Ligands}

Find/create parameters (Mobley) - mention but not totally in scope.

Handle covalently bound cofactors/adducts: Not in our scope but mention that it is a research topic which uses special treatment; refer to how. (As distinct from ones which have parameters available). 

\subsection{Counterions/water}
(minor) Select simulation box size (Mey) -- important, but first thing to check in analysis.

The selection of models not in our scope but will mention (Mobley), including: Water model; Ion model.

(minor) Add solvent then ions, or ions then solvent? Pre-equilibrate ion-water mixture? (Amaro)
Determine electrostatic potential around molecule and place ions at minima (default AMBER approach does this in solvent, replacing some solvent with ions)



\section{Detailed explanation of checklist items}

\subsection{ Step 0: Know what you want to simulate }
\subsection{Protein}

% On protonation states:
%Gianni de Fabritiis has done some nice work on this recently -- 10.1021/acs.jctc.7b00480
%Oliver Beckstein has looked fairly extensively at using proPKA for protein prep -- see https://github.com/Becksteinlab/propkatraj
%Marilyn Gunner has extensively explored the assignment of protonation states on both proteins and now ligands using MCCE2


\subsection{Ligands}
\subsection{Counterions/water}



\section{Acknowledgments}



\bibliography{biomolsetup}


\end{document}
